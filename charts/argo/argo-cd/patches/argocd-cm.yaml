apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
  labels:
    app.kubernetes.io/name: argocd-cm
    app.kubernetes.io/part-of: argocd
data:
  # Argo CD's externally facing base URL (optional). Required when configuring SSO
  url: https://argocd.chonk.city
  admin.enable: "true"
  # Enables application status badge feature
  statusbadge.enabled: "true"

  # Enables anonymous user access. The anonymous users get default role permissions specified argocd-rbac-cm.yaml.
  users.anonymous.enabled: "false"
  extension.config: |-
    extensions:
      - name: metrics
        backend:
          services:
            - url: http://argocd-metrics-server:9003

  accounts.null0x: apiKey, login
  oidc.config: |
    name: OneLogin
    # this is the authorization server URI
    issuer: https://honklabs.onelogin.com/oidc/2
    clientID: 695b32d0-070f-013d-b382-1e9d70d9272c238236
    clientSecret: $argocd-onelogin-oidc:argocd-onelogin-oidc
    requestedScopes: ["openid", "profile", "email", "groups"]
    enablePKCEAuthentication: true
